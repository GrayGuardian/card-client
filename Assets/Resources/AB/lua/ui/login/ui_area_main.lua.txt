local base = require("ui_base")
local UI = class("area_main", base)

----------------UI配置------------------
function UI:GET_AB()
    return "ui1"
end
function UI:GET_DEFAULT_OPTS()
    return {blockInput = false, blackMask = 0}
end
----------------UI配置------------------

function UI:onLoad()
    -- broadcast:on(
    --     BROADCAST_CODE.SOCKET_EVENT("error"),
    --     function(error)
    --         if (error.code == ERROR_CODE.AREA_MAINTENANCE) then
    --             GameData.areaInfo.ismaintenance = 1
    --             self.areaItemComp.info = GameData.areaInfo
    --             self.areaItemComp:refresh()
    --         end
    --     end
    -- )

    self.areaItemComp =
        comp:addComponent(
        self.node:Find("area_item"),
        "area_item",
        {
            info = GameData.areaInfo,
            onClick = function(c)
                ui:showUI(
                    "ui_area_sel",
                    {
                        area = GameData.areaInfo,
                        areas = GameData.areaInfos,
                        onClick = function(info)
                            GameData.areaInfo = info
                            self.areaItemComp.info = GameData.areaInfo
                            self.areaItemComp:refresh()
                        end
                    }
                )
            end
        }
    )
end

function UI:onNextBtnClick(o, order)
    http:send(
        "nextArea",
        {aid = GameData.areaInfo.aid},
        function(data)
            -- GameData.areaInfo.ismaintenance = 0
            -- self.areaItemComp.info = GameData.areaInfo
            -- self.areaItemComp:refresh()

            print("进入选人界面")
            GameData.players = data.players
            ui:showUI("ui_player_sel")
            self:close()
        end
    )
end
return UI
